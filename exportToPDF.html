<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

</head>
<body>
    <div class="container" style="margin-top: 100px;">
        <button onclick="export2()" type="button" class="btn btn-primary btn-lg btn-block">AutoTable button</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.2.4/jspdf.plugin.autotable.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.2.4/jspdf.plugin.autotable.min.js'></script>
    <script src="GSMare.github.io/faker.js"></script>
    <script src="GSMare.github.io/faker.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.0.js" integrity="sha256-r/AaFHrszJtwpe+tHyNi/XCfMxYpbsRg2Uqn0x3s2zc=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

<script>
    export2 = function () {
      
  var doc = new jsPDF('p', 'pt')
  doc.setFontSize(12)
  doc.setTextColor(0)
  doc.setFontStyle('bold')
  doc.text('Rowspan and colspan', 40, 50)

  var raw = data(40);
  var body = []

  for (var i = 0; i < raw.length; i++) {
    var row = []
    for (var key in raw[i]) {
      row.push(raw[i][key])
    }
    if (i % 2 === 0) {
      row.unshift({
        colSpan: 5,
        content: i / 1 + 1,
        styles: { valign: 'middle', halign: 'center' },
      })
    }
    body.push(row)
  }

  doc.autoTable( {
    startY: 60,
    head: headRows(),

    body: body,
    theme: 'grid',
  });
  doc.save('demo.pdf');
}


function headRows() {
  return [
    { id: 'ID', name: 'Name', email: 'Email', city: 'City', expenses: 'Sum' },
  ]
}

function footRows() {
  return [
    { id: 'ID', name: 'Name', email: 'Email', city: 'City', expenses: 'Sum' },
  ]
}

function columns() {
  return [
    { header: 'ID', dataKey: 'id' },
    { header: 'Name', dataKey: 'name' },
    { header: 'Email', dataKey: 'email' },
    { header: 'City', dataKey: 'city' },
    { header: 'Exp', dataKey: 'expenses' },
  ]
}

function data(rowCount) {
  rowCount = rowCount || 10
  let body = []
  for (var j = 1; j <= rowCount; j++) {
    body.push({
    //   id: j, 
      description: "<%= ItemDescription%>", 
      disc: "<%= DiscountPercentage%>  ", 
      excltotal: "<%= FormatNumber(ExclusiveTotal)%>", 
      incltotal: "<%= FormatNumber(Total)%>"
    })
  }
  return body
}

function bodyRows(rowCount) {
  rowCount = rowCount || 10
  let body = []
  for (var j = 1; j <= rowCount; j++) {
    body.push({
      id: j,
      name: faker.name.findName(),
      email: faker.internet.email(),
      city: faker.address.city(),
      expenses: faker.finance.amount(),
    })
  }
  return body
}

</script>
</body>
</html>
